@inherits Nancy.ViewEngines.Razor.NancyRazorViewBase<dynamic>

@{
    Layout = "_master.cshtml";
}

@section PAGEHEADER{
    <div class="pageheader">
        <h2><i class="fa fa-home"></i> @Text.words.Dashboard</h2>
    </div>
}

<div class="row">
    <div class="col-sm-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <div class="panel-btns">
                    <a href="#" class="minimize">&minus;</a>
                </div>
                <!-- panel-btns -->
                <h3 class="panel-title">Company Details</h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div id="areaChartDiv" class="col-sm-8">
                        <div id="areaChart"></div>
                    </div>
                    <div class="col-sm-4">
                        <h5 class="subtitle mb5">Server Status</h5>
                        <p class="mb15">Summary of the status of your server.</p>

                        <span class="sublabel">CPU Usage (40.05 - 32 cpus)</span>
                        <div class="progress progress-sm">
                            <div style="width: 40%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="40" role="progressbar" class="progress-bar progress-bar-primary"></div>
                        </div><!-- progress -->

                        <span class="sublabel">Memory Usage (32.2%)</span>
                        <div class="progress progress-sm">
                            <div style="width: 32%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="40" role="progressbar" class="progress-bar progress-bar-success"></div>
                        </div><!-- progress -->

                        <span class="sublabel">Disk Usage (82.2%)</span>
                        <div class="progress progress-sm">
                            <div style="width: 82%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="40" role="progressbar" class="progress-bar progress-bar-danger"></div>
                        </div><!-- progress -->

                        <span class="sublabel">Databases (63/100)</span>
                        <div class="progress progress-sm">
                            <div style="width: 63%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="40" role="progressbar" class="progress-bar progress-bar-warning"></div>
                        </div><!-- progress -->

                        <span class="sublabel">Domains (2/10)</span>
                        <div class="progress progress-sm">
                            <div style="width: 20%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="40" role="progressbar" class="progress-bar progress-bar-success"></div>
                        </div><!-- progress -->

                        <span class="sublabel">Email Account (13/50)</span>
                        <div class="progress progress-sm">
                            <div style="width: 26%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="40" role="progressbar" class="progress-bar progress-bar-success"></div>
                        </div><!-- progress -->


                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-sm-6">
        <div class="panel panel-default">
            <div class="panel-heading">
                <div class="panel-btns">
                    <a href="#" class="minimize">&minus;</a>
                </div>
                <!-- panel-btns -->
                <h3 class="panel-title">Top 5 Customers</h3>
            </div>
            <div id="pieChartDiv" class="panel-body">
                <div id="pieChart"></div>
            </div>
        </div>
    </div>
    <div class="col-sm-6">
        <div class="panel panel-default widget-messaging">
            <div class="panel-heading">
                <div class="panel-btns">
                    <a href="#" class="minimize">&minus;</a>
                </div>
                <!-- panel-btns -->
                <h3 class="panel-title">Audit Trail</h3>
            </div>
            <div class="panel-body">
                <ul>
                    <li>
                        <small class="pull-right">5/3/2014</small>
                        <h4 class="sender">jdixon@compsysar.com</h4>
                        <small>Deleted user: rwilliams@compsysar.com</small>
                    </li>
                    <li>
                        <small class="pull-right">5/1/2014</small>
                        <h4 class="sender">klape@compsysar.com</h4>
                        <small>Created user: rwilliams@compsysar.com</small>
                    </li>
                    <li>
                        <small class="pull-right">4/29/2014</small>
                        <h4 class="sender">jdixon@compsysar.com</h4>
                        <small>Changed the mailbox plan for: jdixon@compsysar.com</small>
                    </li>
                    <li>
                        <small class="pull-right">4/28/2014</small>
                        <h4 class="sender">jdixon@compsysar.com</h4>
                        <small>Enabled mailbox for: jdixon@compsysar.com</small>
                    </li>
                    <li>
                        <small class="pull-right">4/27/2014</small>
                        <h4 class="sender">klape@compsysar.com</h4>
                        <small>Enabled company for Exchange: Computer Systems and Services</small>
                    </li>
                    <li>
                        <small class="pull-right">4/5/2014</small>
                        <h4 class="sender">klape@compsysar.com</h4>
                        <small>Created company: Computer Systems and Services</small>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

@section CUSTOMJAVASCRIPT{
    <script src="~/Content/js/highcharts/highcharts.js"></script>
    <script type="text/javascript">

        function GenerateAreaChart() {
            var areaChart = new Highcharts.Chart({
                chart: {
                    type: 'area',
                    renderTo: 'areaChart',
                    backgroundColor: 'transparent'
                },
                title: { text: '' },
                credits: { enabled: false },
                yAxis: { min: 0, title: { text: '' } },
                plotOptions: { series: { connectNulls: true } }
            });

            $.ajax({
                type: "get",
                async: true,
                url: "@Url.Content("~/dashboard/chart/area/json")",
                dataType: "json",
                beforeSend: function(jqxhr, settings) {
                    $('#areaChartDiv').block();
                },
                success: function (data) {
                    areaChart.addSeries({ name: "@Text.words.Users", data: data.users });

                    if (data.exchange.length)
                        areaChart.addSeries({ name: "@Text.words.Mailboxes", data: data.exchange });

                    if (data.citrix.length)
                        areaChart.addSeries({ name: "@Text.words.CitrixUsers", data: data.citrix });

                    areaChart.xAxis[0].categories = data.months;
                    areaChart.redraw();
                },
                complete: function (jqxhr, status) {
                    $('#areaChartDiv').unblock();
                }
            });
        }

        function GeneratePieChart() {
            $.ajax({
                type: "get",
                async: true,
                url: "@Url.Content("~/dashboard/chart/pie/json")",
                dataType: "json",
                beforeSend: function (jqxhr, settings) {
                    $('#pieChartDiv').block();
                },
                success: function (data) {
                    var pieChart = new Highcharts.Chart({
                        chart: {
                            renderTo: 'pieChart',
                            plotBackgroundColor: null,
                            plotBorderWidth: null,
                            plotShadow: false
                        },
                        title: { text: '' },
                        credits: { enabled: false },
                        plotOptions: {
                            pie: {
                                allowPointSelect: true,
                                cursor: 'pointer'
                            }
                        },
                        series: [{
                            type: 'pie',
                            name: '@Text.words.Users',
                            data: data.totals
                        }]
                    });
                },
                complete: function (jqxhr, status) {
                    $('#pieChartDiv').unblock();
                }
            });
        }

        $(document).ready(function () {
            
            $('.animate-number').each(function () {
                $(this).animateNumbers($(this).attr("data-value"), true, parseInt($(this).attr("data-animation-duration")));
            });
            
            $.blockUI.defaults.message = "<img src='@Url.Content("~/Content/images/loaders/loader10.gif")' />"
            $.blockUI.defaults.overlayCSS = {};
            $.blockUI.defaults.css = {};

            GeneratePieChart();

            GenerateAreaChart();
        });
    </script>
}